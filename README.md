# Сервис для перевода долларов в рубли

## Описание
Сервис принимает сумму в долларах и переводит в рубли по текущему курсу. Курс берётся с сайта ЦБ РФ(https://cbr.ru).

### Пример использования
Сервис принимет `GET` запросы по корневому url c парметром value - сумма в долларах, которую нужно перевести в рубли.
При успешном запросе севис возвратит статус `200` и json c параметрами:
* status - статус запроса
    * ok - успешный перевод
    * error - ошибка при обработке запроса
* value_in - сумма полученная сервисом
* currency_in - код валюты полученный сервисом
* value_out - результат перевода в доллары
* currency_out - код валюты итоговой суммы

###### Пример успешного запроса
```python
# Пример запроса
GET http://localhost:8000?value=10,1

# Ответ
status_code = 200
json = {"status": "ok", "value_in": 10.1, "currency_out": "rub", "value_out": 758.61, "currency_in": "usd"}
```

### Виды ошибок
При возникновеннии ошибок, сервис будет возвращать статус `400`, и json со слудующими полями:
* status = `error` - статус запроса - ошибка
* error - описание ошибки
    * `param value not found` - переметр `value` не найден в запросе
    * `param value is not float` - указано неверное значение параметра `value`
    * `site https://cbr.ru is not avaliable` - сайт ЦБ РФ недоступен
    * `error with get usd rate` - ошибка при получении курса с сайта ЦБ РФ

###### Пример запроса с ошибкой
```python
# Запрос
GET http://localhost:8000

# Ответ
status_code = 400
json = {"status": "error", "error": "param value not found"}
```

## Требования
Python 3.5+

## Запуск
Для запуска необходимо запустить файл `main.py`
```python
python main.py
```
По умолчанию сервис запустится на `8000` порту, эту настройку можно изменить в файле `config.py` (параметр `server_port`)

### Запуск в docker
Сервис поддерживает запуск через docker. Для этого должен быть установлен docker, после этого в корне сервиса небходимо запустить команду `docker-compose up --build`
По умолчанию порт `8000` на котором запускется сервис прокидывается также на `8000` порт, это можно изменить в файле `docker-compose.yml`

## Структура
* convert_money_server
    * config.py - настройки сервиса
    * utils.py - файл с функциями сервиса
    * main.py - основной файл запуска сервиса
    * test_utils.py - тесты для функций сервиса
    * test_server.py - тесты для сервера
    
* docker-compose.yml - файл для запуска сервиса через docker
* Dockerfile - файл для запуска сервиса через docker
* README.md - описание сервиса


## Тестирование
Для тестирования есть 2 набора тестов:
* test_utils.py - тестирование функций сервиса
* test_server.py - тестирование сервера (выполняется при запущенном сервере)
